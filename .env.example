# ==============================================
# K6 PERFORMANCE TESTING FRAMEWORK
# Environment Configuration Template
# ==============================================
#
# INSTRUCTIONS:
# 1. Copy this file to .env: cp .env.example .env
# 2. Fill in the values for your environment
# 3. Never commit .env to the repository
#
# ==============================================

# Default environment
ENVIRONMENT=local

# ==============================================
# ENVIRONMENT URLS
# ==============================================
# Configure URLs for each environment (local, dev, staging, prod)
# The test will use the corresponding environment based on the command:
#   npm run smoke        -> uses LOCAL_*
#   npm run smoke:dev    -> uses DEV_*
#   npm run smoke:staging -> uses STAGING_*
#   npm run smoke:prod   -> uses PROD_*

# LOCAL ENVIRONMENT
LOCAL_BASE_URL=https://your-local-url.com
LOCAL_PATH=/api-path
LOCAL_TIMEOUT=60s

# Traffic Monitoring (REST API) - LOCAL
LOCAL_AUTH_URL=https://your-auth-url.com/token
LOCAL_TRAFFIC_URL=https://your-traffic-url.com/endpoint
LOCAL_CLIENT_ID=your-client-id
LOCAL_CLIENT_SECRET=your-client-secret
LOCAL_AUTH_GRANT_TYPE=password
LOCAL_AUTH_USERNAME=your-username
LOCAL_AUTH_PASSWORD=your-password

# DEV ENVIRONMENT
DEV_BASE_URL=https://your-dev-url.com
DEV_PATH=/api-path
DEV_TIMEOUT=60s
DEV_AUTH_URL=https://your-dev-auth-url.com/token
DEV_TRAFFIC_URL=https://your-dev-traffic-url.com/endpoint
DEV_CLIENT_ID=your-client-id
DEV_CLIENT_SECRET=your-client-secret

# STAGING ENVIRONMENT
STAGING_BASE_URL=https://your-staging-url.com
STAGING_PATH=/api-path
STAGING_TIMEOUT=90s
STAGING_AUTH_URL=https://your-staging-auth-url.com/token
STAGING_TRAFFIC_URL=https://your-staging-traffic-url.com/endpoint
STAGING_CLIENT_ID=your-client-id
STAGING_CLIENT_SECRET=your-client-secret

# PROD ENVIRONMENT
PROD_BASE_URL=https://your-prod-url.com
PROD_PATH=/api-path
PROD_TIMEOUT=120s
PROD_AUTH_URL=https://your-prod-auth-url.com/token
PROD_TRAFFIC_URL=https://your-prod-traffic-url.com/endpoint
PROD_CLIENT_ID=your-client-id
PROD_CLIENT_SECRET=your-client-secret

# ==============================================
# TEST CONFIGURATION
# ==============================================
# Configure load parameters for each test type

# Common
ACTIVITIES=1
SIZE_MB=0

# SMOKE TEST - Basic functionality check (~15s)
# Verifies the system works with minimal load
SMOKE_DURATION=15s
SMOKE_VUS=1
SMOKE_SLEEP=0.1

# LOAD TEST - Sustained normal load (~9min)
# Tests expected production traffic levels
LOAD_START_RATE=1
LOAD_TIME_UNIT=2s
LOAD_PRE_VUS=30
LOAD_MAX_VUS=200
LOAD_TARGET_RPS=10
LOAD_STAGE1_DURATION=2m
LOAD_STAGE2_DURATION=2m
LOAD_STAGE3_DURATION=2m
LOAD_STAGE4_DURATION=2m
LOAD_STAGE5_DURATION=1m
LOAD_STAGE5_TARGET=0
LOAD_GRACEFUL_STOP=30s
LOAD_LOG_EVERY_BAD=50
LOAD_SLEEP=0.001

# STRESS TEST - Find breaking point (~7min)
# Gradually increases load until failure
STRESS_START_RPS=2
STRESS_TIME_UNIT=1s
STRESS_PRE_VUS=50
STRESS_MAX_VUS=300
STRESS_GRACEFUL_STOP=30s
STRESS_STAGE1_DURATION=1m
STRESS_STAGE1_TARGET=1
STRESS_STAGE2_DURATION=1m
STRESS_STAGE2_TARGET=2
STRESS_STAGE3_DURATION=1m
STRESS_STAGE3_TARGET=3
STRESS_STAGE4_DURATION=1m
STRESS_STAGE4_TARGET=4
STRESS_STAGE5_DURATION=2m
STRESS_STAGE5_TARGET=5
STRESS_STAGE6_DURATION=30s
STRESS_STAGE6_TARGET=0
STRESS_TIMEOUT=90s
STRESS_LOG_EVERY_BAD=20
STRESS_SLEEP=0.001

# CAPACITY TEST - Maximum healthy capacity (~7min)
# Finds the max load where system remains healthy
CAPACITY_START_RPS=2
CAPACITY_TIME_UNIT=1s
CAPACITY_PRE_VUS=50
CAPACITY_MAX_VUS=300
CAPACITY_GRACEFUL_STOP=30s
CAPACITY_STAGE1_DURATION=1m
CAPACITY_STAGE1_TARGET=2
CAPACITY_STAGE2_DURATION=1m
CAPACITY_STAGE2_TARGET=4
CAPACITY_STAGE3_DURATION=1m
CAPACITY_STAGE3_TARGET=6
CAPACITY_STAGE4_DURATION=1m
CAPACITY_STAGE4_TARGET=8
CAPACITY_STAGE5_DURATION=1m
CAPACITY_STAGE5_TARGET=10
CAPACITY_STAGE6_DURATION=1m
CAPACITY_STAGE6_TARGET=12
CAPACITY_STAGE7_DURATION=1m
CAPACITY_STAGE7_TARGET=0
CAPACITY_TIMEOUT=90s
CAPACITY_LOG_EVERY_BAD=20
CAPACITY_SLEEP=0.001

# SPIKE TEST - Traffic bursts (~5min)
# Tests sudden traffic spikes
SPIKE_START_VUS=1
SPIKE_MAX_VUS=100
SPIKE_GRACEFUL_STOP=30s
SPIKE_STAGE1_DURATION=30s
SPIKE_STAGE1_TARGET=5
SPIKE_STAGE2_DURATION=10s
SPIKE_STAGE3_DURATION=1m
SPIKE_STAGE4_DURATION=10s
SPIKE_STAGE4_TARGET=5
SPIKE_STAGE5_DURATION=1m
SPIKE_STAGE5_TARGET=5
SPIKE_STAGE6_DURATION=30s
SPIKE_STAGE6_TARGET=0
SPIKE_LOG_EVERY_BAD=50
SPIKE_SLEEP=0.5

# SOAK TEST - Long-term stability (30min+)
# Tests memory leaks and stability over time
SOAK_VUS=10
SOAK_DURATION=30m
SOAK_GRACEFUL_STOP=30s
SOAK_LOG_EVERY_BAD=100
SOAK_SLEEP=1

# SIZE TEST - Payload limits
# Tests maximum request/response sizes
SIZE_START_MB=0.5
SIZE_MAX_MB=64
SIZE_STEP_MODE=double
SIZE_STEP_MB=1
SIZE_VUS=1
SIZE_TIMEOUT=180s
SIZE_SLEEP=0.2

# COMBINED TEST - SOAP + Traffic Monitoring in parallel (~5min)
# Tests both services simultaneously with progressive RPS
#
# SOAP Service Configuration:
COMBINED_SOAP_START_RPS=1          # Starting RPS for SOAP
COMBINED_SOAP_TIME_UNIT=1s         # Time unit for SOAP rate
COMBINED_SOAP_STAGE1_DURATION=2m
COMBINED_SOAP_STAGE1_TARGET=3
COMBINED_SOAP_STAGE2_DURATION=2m
COMBINED_SOAP_STAGE2_TARGET=5
COMBINED_SOAP_STAGE3_DURATION=1m
COMBINED_SOAP_STAGE3_TARGET=5
COMBINED_SOAP_VUS=20               # Pre-allocated virtual users
COMBINED_SOAP_MAX_VUS=50           # Maximum VUs if needed
COMBINED_SOAP_TIMEOUT=60s          # SOAP request timeout
#
# Traffic Monitoring Configuration:
COMBINED_TRAFFIC_START_RPS=1       # Starting RPS for Traffic
COMBINED_TRAFFIC_TIME_UNIT=1s      # Time unit for Traffic rate
COMBINED_TRAFFIC_STAGE1_DURATION=2m
COMBINED_TRAFFIC_STAGE1_TARGET=3
COMBINED_TRAFFIC_STAGE2_DURATION=2m
COMBINED_TRAFFIC_STAGE2_TARGET=5
COMBINED_TRAFFIC_STAGE3_DURATION=1m
COMBINED_TRAFFIC_STAGE3_TARGET=5
COMBINED_TRAFFIC_VUS=10            # Pre-allocated virtual users
COMBINED_TRAFFIC_MAX_VUS=30        # Maximum VUs if needed
COMBINED_TRAFFIC_TIMEOUT=30s       # Traffic request timeout
COMBINED_TRAFFIC_SLEEP=1           # Sleep when traffic URL is missing
COMBINED_TRAFFIC_MAX_RESPONSE_MS=5000  # Max response time for traffic check

# TRAFFIC MONITORING LOAD TEST
TRAFFIC_LOAD_START_RATE=1
TRAFFIC_LOAD_TIME_UNIT=1s
TRAFFIC_LOAD_PRE_VUS=30
TRAFFIC_LOAD_MAX_VUS=200
TRAFFIC_LOAD_TARGET_RPS=10
TRAFFIC_LOAD_STAGE1_DURATION=3m
TRAFFIC_LOAD_STAGE2_DURATION=5m
TRAFFIC_LOAD_STAGE3_DURATION=1m
TRAFFIC_LOAD_STAGE3_TARGET=0
TRAFFIC_LOAD_SLEEP=0.1

# TRAFFIC MONITORING STRESS TEST
TRAFFIC_STRESS_START_RPS=2
TRAFFIC_STRESS_TIME_UNIT=1s
TRAFFIC_STRESS_PRE_VUS=50
TRAFFIC_STRESS_MAX_VUS=300
TRAFFIC_STRESS_GRACEFUL_STOP=30s
TRAFFIC_STRESS_STAGE1_DURATION=1m
TRAFFIC_STRESS_STAGE1_TARGET=2
TRAFFIC_STRESS_STAGE2_DURATION=1m
TRAFFIC_STRESS_STAGE2_TARGET=4
TRAFFIC_STRESS_STAGE3_DURATION=1m
TRAFFIC_STRESS_STAGE3_TARGET=6
TRAFFIC_STRESS_STAGE4_DURATION=1m
TRAFFIC_STRESS_STAGE4_TARGET=8
TRAFFIC_STRESS_STAGE5_DURATION=1m
TRAFFIC_STRESS_STAGE5_TARGET=10
TRAFFIC_STRESS_STAGE6_DURATION=1m
TRAFFIC_STRESS_STAGE6_TARGET=12
TRAFFIC_STRESS_STAGE7_DURATION=1m
TRAFFIC_STRESS_STAGE7_TARGET=0
TRAFFIC_STRESS_SLEEP=0.1

# TRAFFIC MONITORING SMOKE TEST
TRAFFIC_SMOKE_SLEEP=1

# ==============================================
# THRESHOLDS (ACCEPTANCE LIMITS)
# ==============================================
# Define pass/fail criteria for each test type
# FAILED_RATE: Maximum allowed error rate (0.01 = 1%)
# P95_DURATION: 95th percentile response time in ms
# P99_DURATION: 99th percentile response time in ms

# Smoke Test Thresholds
SMOKE_THRESHOLD_FAILED_RATE=0.01
SMOKE_THRESHOLD_P95_DURATION=2000
SMOKE_THRESHOLD_P99_DURATION=3000

# Load Test Thresholds
LOAD_THRESHOLD_FAILED_RATE=0.10
LOAD_THRESHOLD_P95_DURATION=10000
LOAD_THRESHOLD_P99_DURATION=15000

# Stress Test Thresholds
STRESS_THRESHOLD_FAILED_RATE=0.05
STRESS_THRESHOLD_P95_DURATION=45000
STRESS_THRESHOLD_P99_DURATION=60000
STRESS_THRESHOLD_REJECTED_SEMAPHORE=1000000000
STRESS_THRESHOLD_SHORTCIRCUIT=1000000000

# Capacity Test Thresholds
CAPACITY_THRESHOLD_FAILED_RATE=0.01
CAPACITY_THRESHOLD_P95_DURATION=2000
CAPACITY_THRESHOLD_P99_DURATION=5000
CAPACITY_THRESHOLD_CIRCUIT_BREAKERS=10
CAPACITY_THRESHOLD_SEMAPHORE=10
CAPACITY_THRESHOLD_DROPPED=50

# Spike Test Thresholds
SPIKE_THRESHOLD_FAILED_RATE=0.15
SPIKE_THRESHOLD_P95_DURATION=20000
SPIKE_THRESHOLD_P99_DURATION=30000

# Soak Test Thresholds
SOAK_THRESHOLD_FAILED_RATE=0.05
SOAK_THRESHOLD_P95_DURATION=8000
SOAK_THRESHOLD_P99_DURATION=12000
SOAK_THRESHOLD_AVG_DURATION=5000

# Size Test Thresholds
SIZE_THRESHOLD_FAILED_RATE=0.20
SIZE_THRESHOLD_P95_DURATION=45000

# Combined Test Thresholds
COMBINED_THRESHOLD_FAILED_RATE=0.30
COMBINED_SOAP_THRESHOLD_P95_DURATION=30000
COMBINED_TRAFFIC_THRESHOLD_P95_DURATION=5000
COMBINED_SOAP_THRESHOLD_FAILED_RATE=0.50
COMBINED_TRAFFIC_THRESHOLD_FAILED_RATE=0.10

# ==============================================
# REPORT CONFIGURATION
# ==============================================
REPORTS_DIR=reports
JSON_DIR=reports/json
ALLURE_RESULTS_DIR=reports/allure-results
ALLURE_REPORT_DIR=reports/allure-report
